# Java-Cintegration

Авторски права
© Биляна Билянова 2025.

Всички права запазени. Този код е публикуван само с демонстрационна/образователна цел.

Забранява се копирането, разпространението, модифицирането или използването на съдържанието без изрично писмено разрешение.

Бележка: Всички .java и .c файлове са написани и съхранени в Notepad версия 11.2507.26.0 . За изпълнението на всички действия, свързани с компилиране, построяване (build), свързване (link) и изпълнение на програмата, се използва Command Prompt. 

<img width="1920" height="1080" alt="Main class (1)" src="https://github.com/user-attachments/assets/d629f958-af3f-421d-898e-c4067fddda35" />

1. Чрез командата „javac“ се компилират изходните файлове, които съдържат декларации на Java модулитеим, в .class файлове, които се изпълняват от Java VM.
    javac Main.java FileOperations.java NumberOperations.java LibOperations.java

2. Трябва да бъде генериран JNI заглавен файл - LibOperations.h, който се използва в LibOperations.c. Той предоставя декларация на функциите, които ще бъдат използвани от Java, и осъществява Java свързването.
Използва се командата „javac -h /dir/ /fileName/.java“
    javac -h /dir/ LibOperations.java

3. Построяването на динамична библиотека
Ако приложението осъществява достъп до native библиотеки чрез Java Native Interface (JNI) (ако за създаването първоначално е използвано стандартния Command Prompt), трябва те да се надстроят, защото 32-битова JVM може да използва само 32-битови библиотеки. По подобен начин, 64-битова JVM може да използва само 64-битови оригинални библиотеки (в случая е изпобзвана 64-битова JVM, затова и е необходима 64-битова библиотека).
32-битовата виртуална машина на Java не е широко използвана, затова друг подход е компилиране на 64-битова библиотека. Това може да се осъществи като се използвва x64 Native Tools Command Prompt , конфигуриран от Visual Studio специално за подобни цели. При изпълнението на командата за генериране на DLL трябва да се добавят пътища към директории, в които се намират заглавните файлове jni.h и jni_md.h, използва се -I.
   cl -LD -I"C:\Program Files\Java\jdk-23\include" -I"C:\Program Files\Java\jdk-23\include\win32" -I. LibOperations.c /Fe:Gauss.dll
В Java класа LibOperations изрично се търси библиотеката Gauss.dll, затова резултат от командата за създаването е опоменат - /Fe:Gauss.dll
<img width="1920" height="1080" alt="Main class (1)" src="https://github.com/user-attachments/assets/596176cb-47ef-4653-9892-0e1b76b25814" />

4. Link and Run
Към този момент проектът се състои от две готови компоненти – Java .class файлове и DLL. За да може JVM да открие native библиотеката (в случай, че не се намира в същата директория) се използва командата:
    java -Djava.library.path=/dir/ /JavafileName/
JavafileName се явява главният метод (входната точка на Java програмата) - в случая - Main (Main.java)
Тя задава пътят към директория bin, което позволява на виртуалната машина на Java да намери динамичната библиотека. В края се допълва името на Java метода, който се явява входна точка на програмата. При изпълнение на тази команда програмата стартира и трябва да бъдат подадени първо път към матрица с коефициентите пред неизвестните, после път към стълб от свободните членове на СЛУ, накрая - път към директория, в която да се създаде изходен файл, в който да се запишат изчислените корени на СЛУ.
